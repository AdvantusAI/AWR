%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
%(asctime)s - %(name)s - %(levelname)s - %(message)s
2025-04-30 12:47:38,453 - nightly_job_runner - INFO - Starting nightly job runner...
2025-04-30 12:47:38,453 - nightly_job_runner - INFO - Warehouse filter: All warehouses
2025-04-30 12:47:38,639 - nightly_job_runner - INFO - Nightly job completed successfully
2025-04-30 12:47:38,639 - nightly_job_runner - INFO - Duration: 0:00:00.184811
2025-04-30 12:47:38,639 - nightly_job_runner - INFO - Process 'update_stock_status': False
2025-04-30 12:47:38,639 - nightly_job_runner - INFO -   Updated items: 5
2025-04-30 12:47:38,640 - nightly_job_runner - INFO - Process 'calculate_lost_sales': False
2025-04-30 12:47:38,640 - nightly_job_runner - INFO - Process 'update_safety_stock': False
2025-04-30 12:47:38,641 - nightly_job_runner - INFO - Process 'time_based_parameters': False
2025-04-30 12:47:38,641 - nightly_job_runner - INFO - Process 'expire_deals': True
2025-04-30 12:47:38,641 - nightly_job_runner - INFO - Process 'generate_orders': False
2025-04-30 12:47:38,641 - nightly_job_runner - INFO - Process 'purge_accepted_orders': False
2025-04-30 12:50:00,625 - nightly_job_runner - INFO - Starting nightly job runner...
2025-04-30 12:50:00,625 - nightly_job_runner - INFO - Warehouse filter: All warehouses
2025-04-30 12:50:00,743 - nightly_job_runner - ERROR - Nightly job failed: 'Logger' object has no attribute 'info'
2025-04-30 12:50:46,523 - nightly_job_runner - INFO - Starting nightly job runner...
2025-04-30 12:50:46,523 - nightly_job_runner - INFO - Warehouse filter: All warehouses
2025-04-30 12:50:46,736 - nightly_job_runner - INFO - Nightly job completed successfully
2025-04-30 12:50:46,736 - nightly_job_runner - INFO - Duration: 0:00:00.211353
2025-04-30 12:50:46,736 - nightly_job_runner - INFO - Process 'update_stock_status': False
2025-04-30 12:50:46,736 - nightly_job_runner - INFO -   Updated items: 5
2025-04-30 12:50:46,736 - nightly_job_runner - INFO - Process 'calculate_lost_sales': False
2025-04-30 12:50:46,737 - nightly_job_runner - INFO - Process 'update_safety_stock': False
2025-04-30 12:50:46,737 - nightly_job_runner - INFO - Process 'time_based_parameters': False
2025-04-30 12:50:46,737 - nightly_job_runner - INFO - Process 'expire_deals': True
2025-04-30 12:50:46,737 - nightly_job_runner - INFO - Process 'generate_orders': False
2025-04-30 12:50:46,737 - nightly_job_runner - INFO - Process 'purge_accepted_orders': False
2025-04-30 14:12:49,969 - nightly_job_runner - INFO - Starting nightly job runner...
2025-04-30 14:12:49,970 - nightly_job_runner - INFO - Warehouse filter: All warehouses
2025-04-30 14:12:50,209 - nightly_job_runner - INFO - Nightly job completed successfully
2025-04-30 14:12:50,209 - nightly_job_runner - INFO - Duration: 0:00:00.238927
2025-04-30 14:12:50,209 - nightly_job_runner - INFO - Process 'update_stock_status': False
2025-04-30 14:12:50,209 - nightly_job_runner - INFO -   Updated items: 5
2025-04-30 14:12:50,210 - nightly_job_runner - INFO - Process 'calculate_lost_sales': False
2025-04-30 14:12:50,210 - nightly_job_runner - INFO - Process 'update_safety_stock': False
2025-04-30 14:12:50,210 - nightly_job_runner - INFO - Process 'time_based_parameters': False
2025-04-30 14:12:50,210 - nightly_job_runner - INFO - Process 'expire_deals': True
2025-04-30 14:12:50,210 - nightly_job_runner - INFO - Process 'generate_orders': False
2025-04-30 14:12:50,210 - nightly_job_runner - INFO - Process 'purge_accepted_orders': False
2025-04-30 14:19:34,528 - nightly_job_runner - INFO - Starting nightly job runner...
2025-04-30 14:19:34,529 - nightly_job_runner - INFO - Warehouse filter: All warehouses
2025-04-30 14:19:34,734 - nightly_job_runner - ERROR - Nightly job failed: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.UniqueViolation) llave duplicada viola restricción de unicidad «demand_history_pkey»
DETAIL:  Ya existe la llave (id)=(29).

[SQL: INSERT INTO demand_history (item_id, period_number, period_year, shipped, lost_sales, promotional_demand, total_demand, is_ignored, is_adjusted, out_of_stock_days) VALUES (%(item_id)s, %(period_number)s, %(period_year)s, %(shipped)s, %(lost_sales)s, %(promotional_demand)s, %(total_demand)s, %(is_ignored)s, %(is_adjusted)s, %(out_of_stock_days)s) RETURNING demand_history.id]
[parameters: {'item_id': 1, 'period_number': 5, 'period_year': 2025, 'shipped': 0.0, 'lost_sales': 0.0, 'promotional_demand': 0.0, 'total_demand': 0.0, 'is_ignored': False, 'is_adjusted': False, 'out_of_stock_days': 0}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
2025-04-30 14:29:57,603 - nightly_job_runner - INFO - Starting nightly job runner...
2025-04-30 14:29:57,604 - nightly_job_runner - INFO - Warehouse filter: All warehouses
2025-04-30 14:29:57,853 - nightly_job_runner - ERROR - Nightly job failed: (psycopg2.ProgrammingError) can't adapt type 'BuyerClassCode'
[SQL: SELECT item.id AS item_id_1, item.item_id AS item_item_id, item.description AS item_description, item.vendor_id AS item_vendor_id, item.warehouse_id AS item_warehouse_id, item.service_level_goal AS item_service_level_goal, item.service_level_maintained AS item_service_level_maintained, item.lead_time_forecast AS item_lead_time_forecast, item.lead_time_variance AS item_lead_time_variance, item.lead_time_maintained AS item_lead_time_maintained, item.buying_multiple AS item_buying_multiple, item.minimum_quantity AS item_minimum_quantity, item.purchase_price AS item_purchase_price, item.sales_price AS item_sales_price, item.buyer_id AS item_buyer_id, item.buyer_class AS item_buyer_class, item.on_hand AS item_on_hand, item.on_order AS item_on_order, item.customer_back_order AS item_customer_back_order, item.reserved AS item_reserved, item.held_until AS item_held_until, item.quantity_held AS item_quantity_held, item.auxiliary_balance AS item_auxiliary_balance, item.sstf AS item_sstf, item.item_order_point_days AS item_item_order_point_days, item.item_order_point_units AS item_item_order_point_units, item.vendor_order_point_days AS item_vendor_order_point_days, item.order_up_to_level_days AS item_order_up_to_level_days, item.order_up_to_level_units AS item_order_up_to_level_units, item.item_cycle_days AS item_item_cycle_days, item.demand_weekly AS item_demand_weekly, item.demand_4weekly AS item_demand_4weekly, item.demand_monthly AS item_demand_monthly, item.demand_quarterly AS item_demand_quarterly, item.demand_yearly AS item_demand_yearly, item.madp AS item_madp, item.track AS item_track, item.service_level_attained AS item_service_level_attained, item.manual_ss AS item_manual_ss, item.manual_ss_type AS item_manual_ss_type 
FROM item 
WHERE item.buyer_class IN (%(buyer_class_1_1)s, %(buyer_class_1_2)s)]
[parameters: {'buyer_class_1_1': <BuyerClassCode.REGULAR: 'R'>, 'buyer_class_1_2': <BuyerClassCode.WATCH: 'W'>}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-04-30 14:40:51,261 - nightly_job_runner - INFO - Starting nightly job runner...
2025-04-30 14:40:51,262 - nightly_job_runner - INFO - Warehouse filter: All warehouses
2025-04-30 14:40:51,618 - nightly_job_runner - ERROR - Nightly job failed: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.UniqueViolation) llave duplicada viola restricción de unicidad «demand_history_pkey»
DETAIL:  Ya existe la llave (id)=(30).

[SQL: INSERT INTO demand_history (item_id, period_number, period_year, shipped, lost_sales, promotional_demand, total_demand, is_ignored, is_adjusted, out_of_stock_days) VALUES (%(item_id)s, %(period_number)s, %(period_year)s, %(shipped)s, %(lost_sales)s, %(promotional_demand)s, %(total_demand)s, %(is_ignored)s, %(is_adjusted)s, %(out_of_stock_days)s) RETURNING demand_history.id]
[parameters: {'item_id': 1, 'period_number': 5, 'period_year': 2025, 'shipped': 0.0, 'lost_sales': 0.0, 'promotional_demand': 0.0, 'total_demand': 0.0, 'is_ignored': False, 'is_adjusted': False, 'out_of_stock_days': 0}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
2025-04-30 15:05:59,781 - nightly_job_runner - INFO - Starting nightly job runner...
2025-04-30 15:05:59,782 - nightly_job_runner - INFO - Warehouse filter: All warehouses
2025-04-30 15:06:00,242 - nightly_job_runner - ERROR - Nightly job failed: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.UniqueViolation) llave duplicada viola restricción de unicidad «demand_history_pkey»
DETAIL:  Ya existe la llave (id)=(31).

[SQL: INSERT INTO demand_history (item_id, period_number, period_year, shipped, lost_sales, promotional_demand, total_demand, is_ignored, is_adjusted, out_of_stock_days) VALUES (%(item_id)s, %(period_number)s, %(period_year)s, %(shipped)s, %(lost_sales)s, %(promotional_demand)s, %(total_demand)s, %(is_ignored)s, %(is_adjusted)s, %(out_of_stock_days)s) RETURNING demand_history.id]
[parameters: {'item_id': 1, 'period_number': 5, 'period_year': 2025, 'shipped': 0.0, 'lost_sales': 0.0, 'promotional_demand': 0.0, 'total_demand': 0.0, 'is_ignored': False, 'is_adjusted': False, 'out_of_stock_days': 0}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
2025-04-30 15:10:20,952 - nightly_job_runner - INFO - Starting nightly job runner...
2025-04-30 15:10:20,953 - nightly_job_runner - INFO - Warehouse filter: All warehouses
2025-04-30 15:10:21,254 - nightly_job_runner - ERROR - Nightly job failed: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.UniqueViolation) llave duplicada viola restricción de unicidad «demand_history_pkey»
DETAIL:  Ya existe la llave (id)=(32).

[SQL: INSERT INTO demand_history (item_id, period_number, period_year, shipped, lost_sales, promotional_demand, total_demand, is_ignored, is_adjusted, out_of_stock_days) VALUES (%(item_id)s, %(period_number)s, %(period_year)s, %(shipped)s, %(lost_sales)s, %(promotional_demand)s, %(total_demand)s, %(is_ignored)s, %(is_adjusted)s, %(out_of_stock_days)s) RETURNING demand_history.id]
[parameters: {'item_id': 1, 'period_number': 5, 'period_year': 2025, 'shipped': 0.0, 'lost_sales': 0.0, 'promotional_demand': 0.0, 'total_demand': 0.0, 'is_ignored': False, 'is_adjusted': False, 'out_of_stock_days': 0}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
2025-04-30 15:11:26,514 - nightly_job_runner - INFO - Starting nightly job runner...
2025-04-30 15:11:26,514 - nightly_job_runner - INFO - Warehouse filter: All warehouses
2025-04-30 15:11:26,696 - nightly_job_runner - ERROR - Nightly job failed: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.UniqueViolation) llave duplicada viola restricción de unicidad «demand_history_pkey»
DETAIL:  Ya existe la llave (id)=(33).

[SQL: INSERT INTO demand_history (item_id, period_number, period_year, shipped, lost_sales, promotional_demand, total_demand, is_ignored, is_adjusted, out_of_stock_days) VALUES (%(item_id)s, %(period_number)s, %(period_year)s, %(shipped)s, %(lost_sales)s, %(promotional_demand)s, %(total_demand)s, %(is_ignored)s, %(is_adjusted)s, %(out_of_stock_days)s) RETURNING demand_history.id]
[parameters: {'item_id': 1, 'period_number': 5, 'period_year': 2025, 'shipped': 0.0, 'lost_sales': 0.0, 'promotional_demand': 0.0, 'total_demand': 0.0, 'is_ignored': False, 'is_adjusted': False, 'out_of_stock_days': 0}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
