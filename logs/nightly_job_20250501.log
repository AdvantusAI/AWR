2025-05-01 08:29:11,822 - batch - INFO - Starting nightly job at 2025-05-01 08:29:11.821999
2025-05-01 08:29:11,823 - batch - INFO - # Step 1: Update stock status
2025-05-01 08:29:11,975 - batch - INFO - # Step 2: Calculate lost sales
2025-05-01 08:29:12,005 - batch - INFO - # Step 3: Update safety stock levels
2025-05-01 08:29:12,105 - batch - INFO - # Step 4: Process time-based parameters
2025-05-01 08:29:12,114 - batch - INFO - # Step 5: Expire deals
2025-05-01 08:29:12,164 - batch - INFO - Nightly job completed successfully in 0:00:00.342794
2025-05-01 08:30:38,693 - batch - INFO - Starting nightly job at 2025-05-01 08:30:38.693538
2025-05-01 08:30:38,693 - batch - INFO - # Step 1: Update stock status
2025-05-01 08:30:38,845 - batch - INFO - # Step 2: Calculate lost sales
2025-05-01 08:30:38,877 - batch - INFO - # Step 3: Update safety stock levels
2025-05-01 08:30:38,996 - batch - INFO - # Step 4: Process time-based parameters
2025-05-01 08:30:38,999 - batch - INFO - # Step 5: Expire deals
2025-05-01 08:30:39,039 - batch - INFO - Nightly job completed successfully in 0:00:00.345580
2025-05-01 08:31:06,283 - batch - INFO - Starting nightly job at 2025-05-01 08:31:06.283481
2025-05-01 08:31:06,283 - batch - INFO - # Step 1: Update stock status
2025-05-01 08:31:06,406 - batch - INFO - # Step 2: Calculate lost sales
2025-05-01 08:31:06,437 - batch - INFO - # Step 3: Update safety stock levels
2025-05-01 08:31:06,532 - batch - INFO - # Step 4: Process time-based parameters
2025-05-01 08:31:06,536 - batch - INFO - # Step 5: Expire deals
2025-05-01 08:31:06,577 - batch - INFO - Nightly job completed successfully in 0:00:00.294125
2025-05-01 08:58:16,977 - batch - INFO - Starting nightly job at 2025-05-01 08:58:16.977486
2025-05-01 08:58:16,978 - batch - INFO - # Step 1: Update stock status
2025-05-01 08:58:17,140 - batch - INFO - # Step 2: Calculate lost sales
2025-05-01 08:58:17,171 - batch - INFO - # Step 3: Update safety stock levels
2025-05-01 08:58:17,273 - batch - INFO - # Step 4: Process time-based parameters
2025-05-01 08:58:17,281 - batch - INFO - # Step 5: Expire deals
2025-05-01 08:58:17,327 - batch - INFO - Nightly job completed successfully in 0:00:00.350095
2025-05-01 10:46:11,359 - batch - INFO - Starting nightly job at 2025-05-01 10:46:11.354829
2025-05-01 10:46:11,360 - batch - INFO - # Step 1: Update stock status
2025-05-01 10:46:11,565 - batch - INFO - # Step 2: Calculate lost sales
2025-05-01 10:46:11,597 - batch - INFO - # Step 3: Update safety stock levels
2025-05-01 10:46:11,693 - batch - INFO - # Step 4: Process time-based parameters
2025-05-01 10:46:11,701 - batch - INFO - # Step 5: Expire deals
2025-05-01 10:46:11,702 - batch - INFO - # Step 7: Generate orders
2025-05-01 10:46:11,738 - batch - INFO - # Step 8: Purge accepted orders
2025-05-01 10:46:11,745 - batch - INFO - # Step 9: Running AI analysis
2025-05-01 10:46:11,795 - warehouse_replenishment.services.ai_agent_service - ERROR - Error saving AI analysis to database: (builtins.TypeError) Object of type datetime is not JSON serializable
[SQL: INSERT INTO ai_analysis (analysis_date, job_date, overall_health, executive_summary, total_items_processed, total_orders_generated, lost_sales_value, out_of_stock_count, detailed_analysis, insights, recommendations, processing_duration, error_message) VALUES (%(analysis_date)s, %(job_date)s, %(overall_health)s, %(executive_summary)s, %(total_items_processed)s, %(total_orders_generated)s, %(lost_sales_value)s, %(out_of_stock_count)s, %(detailed_analysis)s::JSON, %(insights)s::JSON, %(recommendations)s::JSON, %(processing_duration)s, %(error_message)s) RETURNING ai_analysis.id]
[parameters: [{'total_items_processed': 40, 'total_orders_generated': 0, 'processing_duration': 0.390422, 'analysis_date': datetime.datetime(2025, 5, 1, 10, 46, 11, ... (1640 characters truncated) ... orders': {'total_orders': 0, 'purged_orders': 0, 'errors': 0}}, 'ai_analysis': None, 'success': True}, 'lost_sales_value': 0.0, 'error_message': None}]]
2025-05-01 10:46:11,795 - warehouse_replenishment.services.ai_agent_service - ERROR - Error in nightly job analysis: (builtins.TypeError) Object of type datetime is not JSON serializable
[SQL: INSERT INTO ai_analysis (analysis_date, job_date, overall_health, executive_summary, total_items_processed, total_orders_generated, lost_sales_value, out_of_stock_count, detailed_analysis, insights, recommendations, processing_duration, error_message) VALUES (%(analysis_date)s, %(job_date)s, %(overall_health)s, %(executive_summary)s, %(total_items_processed)s, %(total_orders_generated)s, %(lost_sales_value)s, %(out_of_stock_count)s, %(detailed_analysis)s::JSON, %(insights)s::JSON, %(recommendations)s::JSON, %(processing_duration)s, %(error_message)s) RETURNING ai_analysis.id]
[parameters: [{'total_items_processed': 40, 'total_orders_generated': 0, 'processing_duration': 0.390422, 'analysis_date': datetime.datetime(2025, 5, 1, 10, 46, 11, ... (1640 characters truncated) ... orders': {'total_orders': 0, 'purged_orders': 0, 'errors': 0}}, 'ai_analysis': None, 'success': True}, 'lost_sales_value': 0.0, 'error_message': None}]]
2025-05-01 10:46:11,800 - warehouse_replenishment.services.ai_agent_service - ERROR - Error saving AI analysis to database: (builtins.TypeError) Object of type datetime is not JSON serializable
[SQL: INSERT INTO ai_analysis (analysis_date, job_date, overall_health, executive_summary, total_items_processed, total_orders_generated, lost_sales_value, out_of_stock_count, detailed_analysis, insights, recommendations, processing_duration, error_message) VALUES (%(analysis_date)s, %(job_date)s, %(overall_health)s, %(executive_summary)s, %(total_items_processed)s, %(total_orders_generated)s, %(lost_sales_value)s, %(out_of_stock_count)s, %(detailed_analysis)s::JSON, %(insights)s::JSON, %(recommendations)s::JSON, %(processing_duration)s, %(error_message)s) RETURNING ai_analysis.id]
[parameters: [{'total_items_processed': 40, 'total_orders_generated': 0, 'processing_duration': 0.390422, 'analysis_date': datetime.datetime(2025, 5, 1, 10, 46, 11, ... (2653 characters truncated) ... : []}, 'purge_accepted_orders': {'total_orders': 0, 'purged_orders': 0, 'errors': 0}}, 'ai_analysis': None, 'success': True}, 'lost_sales_value': 0.0}]]
2025-05-01 10:46:11,801 - warehouse_replenishment.services.ai_agent_service - ERROR - Failed to save error analysis to database: (builtins.TypeError) Object of type datetime is not JSON serializable
[SQL: INSERT INTO ai_analysis (analysis_date, job_date, overall_health, executive_summary, total_items_processed, total_orders_generated, lost_sales_value, out_of_stock_count, detailed_analysis, insights, recommendations, processing_duration, error_message) VALUES (%(analysis_date)s, %(job_date)s, %(overall_health)s, %(executive_summary)s, %(total_items_processed)s, %(total_orders_generated)s, %(lost_sales_value)s, %(out_of_stock_count)s, %(detailed_analysis)s::JSON, %(insights)s::JSON, %(recommendations)s::JSON, %(processing_duration)s, %(error_message)s) RETURNING ai_analysis.id]
[parameters: [{'total_items_processed': 40, 'total_orders_generated': 0, 'processing_duration': 0.390422, 'analysis_date': datetime.datetime(2025, 5, 1, 10, 46, 11, ... (2653 characters truncated) ... : []}, 'purge_accepted_orders': {'total_orders': 0, 'purged_orders': 0, 'errors': 0}}, 'ai_analysis': None, 'success': True}, 'lost_sales_value': 0.0}]]
2025-05-01 10:46:11,802 - batch - INFO - Nightly job completed successfully in 0:00:00.390422. AI Analysis Health: ERROR
